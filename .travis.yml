sudo: required
language: bash
services: docker
language: generic

before_script:
  - sudo apt-get -y install qemu-user-static
  - sudo -E docker login -u="${DOCKER_USERNAME}" -p="${DOCKER_PASSWORD}"

jobs:
  include:
    - stage: build functest-core images
      script: sudo -E bash build.sh
      env:
        - repo="${DOCKER_USERNAME}"
        - x86_64_dirs=""
        - aarch64_dirs="docker/core"
    - stage: build all functest images
      script: sudo -E bash build.sh
      env:
        - repo="${DOCKER_USERNAME}"
        - x86_64_dirs=""
        - aarch64_dirs="docker/healthcheck"
    - script: sudo -E bash build.sh
      env:
        - repo="${DOCKER_USERNAME}"
        - x86_64_dirs=""
        - aarch64_dirs="docker/smoke"
    - script: sudo -E bash build.sh
      env:
        - repo="${DOCKER_USERNAME}"
        - x86_64_dirs=""
        - aarch64_dirs="docker/features"
    - script: sudo -E bash build.sh
      env:
        - repo="${DOCKER_USERNAME}"
        - x86_64_dirs=""
        - aarch64_dirs="docker/components"
